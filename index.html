function extractPlanValue() {
            if (!workbookData || workbookData.length < 2) {
                console.log('ワークブックデータが存在しません。デフォルト値を使用します。');
                return;
            }
            
            // E列（インデックス4）で「PLAN」を検索
            let planRowIndex = -1;
            for (let i = 0; i < workbookData.length; i++) {
                const row = workbookData[i];
                if (row && row[4] && typeof row[4] === 'string') {
                    const cellText = row[4].toString().trim().toUpperCase();
                    if (cellText.includes('PLAN')) {
                        planRowIndex = i;
                        console.log(`E列の${i + 1}行目でPLANを発見: "${row[4]}"`);
                        break;
                    }
                }
            }
            
            if (planRowIndex === -1) {
                console.log('E列にPLANが見つかりません。デフォルト値を使用します。');
                return;
            }
            
            // 現在選択されている日付に対応する列のPLAN数値を取得
            const targetDateStr = document.getElementById('targetDate').value;
            if (!targetDateStr) {
                console.log('日付が選択されていません。デフォルト値を使用します。');
                return;
            }
            
            const targetDate = new Date(targetDateStr);
            let targetColumnIndex = -1;
            let minDiff = Infinity;
            
            // 指定日付に最も近い日付列を見つける
            dateColumns.forEach(col => {
                const diff = Math.abs(col.date.getTime() - targetDate.getTime());
                if (diff < minDiff) {
                    minDiff = diff;
                    targetColumnIndex = col.index;
                }
            });
            
            if (targetColumnIndex === -1) {
                console.log('指定日付に対応する列が見つかりません。デフォルト値を使用します。');
                return;
            }
            
            // 指定列のPLAN数値を取得
            const planRow = workbookData[planRowIndex];
            const cellValue = planRow[targetColumnIndex];
            if (typeof cellValue === 'number' && cellValue > 0 && cellValue < 1000000) {
                planValue = cellValue;
                console.log(`PLAN行の${targetDate.toLocaleDateString('ja-JP')}列からPLAN数値を取得: ${planValue}`);
                return;
            }
            
            // 文字列の場合、数値部分を抽出
            if (typeof cellValue === 'string') {
                const numMatch = cellValue.match(/(\d+)/);
                if (numMatch) {
                    const extractedNum = parseInt(numMatch[1]);
                    if (extractedNum > 0 && extractedNum < 1000000) {
                        planValue = extractedNum;
                        console.log(`PLAN行の${targetDate.toLocaleDateString('ja-JP')}列からPLAN数値を抽出: ${planValue}`);
                        return;
                    }
                }
            }
            
            console.log(`PLAN行の${targetDate.toLocaleDateString('ja-JP')}列からPLAN数値を取得できませんでした。デフォルト値を使用します。`);
        }
